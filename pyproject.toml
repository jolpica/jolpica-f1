[tool.poetry]
authors = ["Jolpica <you@example.com>"]
description = ""
name = "jolpica"
version = "0.1.0"

[tool.poetry.dependencies]
Django = "^4.2.5"
django-environ = "^0.11.2"
django-storages = "^1.14.2"
djangorestframework = "^3.14.0"
gunicorn = "^21.2.0"
psycopg = "^3.1.12"
python = ">=3.9,<3.13"
requests = "^2.31.0"
uvicorn = "^0.24.0.post1"

[tool.poetry.group.dev.dependencies]
django-dbml = "^0.6.0"          # Generation of dbml file
django-fixture-magic = "^0.1.5" # Generation of fixture file
django-stubs = { extras = ["compatible-mypy"], version = "^4.2.6" }
djangorestframework-stubs = { extras = ["compatible-mypy"], version = "^3.14.3" }
mypy = { extras = ["dmypy"], version = "^1.5.1" }
pytest-django = "^4.5.2"
ruff = "^0.1.3"

[tool.poetry.group.local.dependencies]
# Only for local development e.g. Jupyter notebook
ipykernel = "^6.25.2"
jupyter = "^1.0.0"
notebook = "^7.0.6"

[tool.poetry.group.import.dependencies]
# Only used in import scripts
pandas = "^2.1.1"
tqdm = "^4.66.1"


[tool.poetry.group.deploy.dependencies]
boto3 = "^1.34.11" # For upload via collectstatic with django-storages

[build-system]
build-backend = "poetry.core.masonry.api"
requires = ["poetry-core>=1.0.0"]


[tool.mypy]
exclude = ["^tests", "^jolpica/ergast"]
plugins = ["mypy_django_plugin.main", "mypy_drf_plugin.main"]

[tool.django-stubs]
django_settings_module = "jolpica.settings"


[tool.ruff]
line-length = 120
src = ["src"]
target-version = "py310"

extend-exclude = ["**/migrations", "jolpica/ergast/*"]
ignore = ["TRY300", "TRY003", "RUF012"]
select = [
    "RUF", # Ruff specific
    "I",   # isort - Import sorting
    "S",   # Bandit - Security Report
    "F",   # Pyflakes - Error Checker
    "E",   # Pycodestyle - Style Checker
    "UP",  # Pyupgrade - Update Old Syntax
    "N",   # pep8-naming - Naming Conventions
    "TRY", # Tryceratops - Try Except Checking
]

pydocstyle.convention = "google"

[tool.ruff.per-file-ignores]
"**/tests/*.py" = ["D", "S", "E501"]
"*/__init__.py" = ["F401"]


[tool.pytest.ini_options]
DJANGO_SETTINGS_MODULE = "tests.settings"
addopts = ["--reuse-db"]
